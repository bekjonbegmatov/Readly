<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Readly</title>
    <meta name="color-scheme" content="light">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ['Inter', 'system-ui', 'Segoe UI', 'Helvetica', 'Arial', 'sans-serif'] },
            colors: {
              brand: {
                DEFAULT: '#0a84ff',
                ink: '#004fba'
              }
            },
            boxShadow: {
              soft: '0 1px 2px rgba(16,24,40,.06), 0 8px 24px rgba(16,24,40,.08)'
            },
            borderRadius: { xl: '20px' }
          }
        }
      }
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <header class="sticky top-0 z-20 border-b border-gray-200 bg-white">
      <div class="mx-auto max-w-5xl px-4 py-3 flex items-center gap-3">
        <a href="/" class="font-semibold tracking-tight text-gray-900">Readly</a>
        <form action="/search/" method="get" role="search" class="flex-1">
          <input type="search" name="q" value="{{ request.GET.q|default:'' }}" aria-label="Поиск"
                 placeholder="Поиск статей и авторов"
                 class="w-full rounded-full border border-gray-300 bg-gray-50 px-4 py-2 outline-none focus:border-brand focus:ring-4 focus:ring-brand/20" />
        </form>
        <nav class="flex items-center gap-2" aria-label="Действия">
          {% if user.is_authenticated %}
            <a href="/article/create/" class="inline-flex items-center gap-2 rounded-md bg-brand px-3 py-2 text-white shadow-soft" aria-label="Создать статью">
              <i data-lucide="pen-square" class="w-4 h-4"></i><span class="hidden sm:inline">Написать</span>
            </a>
            <a href="/u/{{ user.username }}/" class="inline-flex items-center justify-center rounded-full border border-gray-200 bg-gray-100 w-8 h-8 text-gray-600" aria-label="Профиль">
              {{ user.username|slice:":1"|upper }}
            </a>
          {% else %}
            <a href="/login/" class="text-brand" aria-label="Войти">Вход</a>
            <a href="/signup/" class="text-brand" aria-label="Регистрация">Регистрация</a>
          {% endif %}
        </nav>
      </div>
    </header>
    <main class="mx-auto max-w-5xl px-4 py-4 pb-20">
      {% block content %}{% endblock %}
    </main>
    <footer class="fixed bottom-0 left-0 right-0 z-30 border-t border-gray-200 bg-white" role="navigation" aria-label="Нижняя панель">
      <div class="mx-auto max-w-5xl px-4 py-2 grid grid-cols-5">
        <a href="/" class="flex flex-col items-center text-sm {% if request.path == '/' %}text-brand{% else %}text-gray-500{% endif %}">
          <i data-lucide="home" class="w-5 h-5"></i>
          Главная
        </a>
        <a href="/search/" target="_self" class="flex flex-col items-center text-sm {% if '/search/' in request.path %}text-brand{% else %}text-gray-500{% endif %}">
          <i data-lucide="search" class="w-5 h-5"></i>
          Поиск
        </a>
        <a href="/article/create/" class="flex flex-col items-center text-sm {% if '/article/create/' in request.path %}text-brand{% else %}text-gray-500{% endif %}">
          <i data-lucide="square-pen" class="w-5 h-5"></i>
          Добавить
        </a>
        <a href="/favorites/" class="flex flex-col items-center text-sm {% if '/favorites/' in request.path %}text-brand{% else %}text-gray-500{% endif %}">
          <i data-lucide="bookmark" class="w-5 h-5"></i>
          Избранное
        </a>
        {% if user.is_authenticated %}
        <a href="/u/{{ user.username }}/" class="flex flex-col items-center text-sm {% if '/u/' in request.path %}text-brand{% else %}text-gray-500{% endif %}">
          <i data-lucide="user" class="w-5 h-5"></i>
          Профиль
        </a>
        {% else %}
        <a href="/login/" class="flex flex-col items-center text-sm {% if '/login/' in request.path %}text-brand{% else %}text-gray-500{% endif %}">
          <i data-lucide="log-in" class="w-5 h-5"></i>
          Войти
        </a>
        {% endif %}
      </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', ()=>{
        if (window.lucide) { window.lucide.createIcons(); }
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/static/sw.js').catch(()=>{});
        }
      });
    </script>
    <link rel="manifest" href="/static/manifest.webmanifest">
    <meta name="theme-color" content="#0a84ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="apple-touch-icon" href="https://via.placeholder.com/192.png/0a84ff/ffffff?text=R">
</body>
</html>